TODO: use guards in case clauses